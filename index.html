<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Inkwell by salkar</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Inkwell</h1>
        <h2>Inkwell provides simple way to add social networking features like comments, reblogs, favorites, following/followers, communities and timelines to your Ruby on Rails application.</h2>
        <a href="https://github.com/salkar/inkwell" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>= Inkwell</h1>

<p>Inkwell provides simple way to add social networking features like comments, reblogs, favorites, following/followers, communities and timelines to your Ruby on Rails application.</p>

<p>Russian translation of README file available here[<a href="https://github.com/salkar/inkwell/blob/master/README_RU.rdoc">https://github.com/salkar/inkwell/blob/master/README_RU.rdoc</a>].</p>

<p>== Requirements
You should have two classes: User and Post or other identical. Between them should be a one-to-many relationship. For example:</p>

<p>class User &lt; ActiveRecord::Base
    has_many :posts
  end</p>

<p>class Post &lt; ActiveRecord::Base
    belongs_to :user
  end</p>

<p>If you want to use communities[<a href="https://github.com/salkar/inkwell#community-feature">https://github.com/salkar/inkwell#community-feature</a>], then you need to have <code>Community</code> class, too:</p>

<p>class Community &lt; ActiveRecord::Base
  end</p>

<p>== Installation</p>

<p>Put in <code>Gemfile</code>:</p>

<p>gem 'inkwell', :git =&gt; 'git://github.com/salkar/inkwell.git'</p>

<p>After it do <code>bundle install</code></p>

<p>Add to your <code>User</code> model <code>acts_as_inkwell_user</code> and to your <code>Post</code> model <code>acts_as_inkwell_post</code></p>

<p>class User &lt; ActiveRecord::Base
    has_many :posts
    acts_as_inkwell_user
  end</p>

<p>class Post &lt; ActiveRecord::Base
    belongs_to :user
    acts_as_inkwell_post
  end</p>

<p>If you want to use communities, then add to your <code>Community</code> model <code>acts_as_inkwell_community</code>:</p>

<p>class Community &lt; ActiveRecord::Base
    acts_as_inkwell_community
  end</p>

<p>Create <code>inkwell.rb</code> file in <code>config/initializers</code> and put in it your names of <code>User</code> and <code>Post</code> tables (or other identical). 
Put in it name of <code>Community</code> table if you want to use it:</p>

<p>module Inkwell
    class Engine &lt; Rails::Engine
      config.post_table = :posts
      config.user_table = :users
      config.community_table = :communities #if you want to use communities
    end
  end</p>

<p>Next, get gem migrations:</p>

<p>rake inkwell:install:migrations</p>

<p>and <code>db:migrate</code> it.</p>

<p>== Usage</p>

<p>=== Favorite features</p>

<p>User is able to favorite posts/comments:</p>

<p>@user.favorite <a href="https://github.com/post" class="user-mention">@post</a>
  @user.favorite <a href="https://github.com/comment" class="user-mention">@comment</a></p>

<p>To delete post/comment from favorites:</p>

<p>@user.unfavorite <a href="https://github.com/post" class="user-mention">@post</a></p>

<p>To check that post/comment enters in favorites:</p>

<p>@user.favorite? <a href="https://github.com/post" class="user-mention">@post</a></p>

<p>To return favorite line, consisting of favorited posts and comments:</p>

<p>@user.favoriteline(:last_shown_obj_id =&gt; nil, :limit =&gt; 10, :for_user =&gt; nil)</p>

<p>where </p>

<ul>
<li>
<p><code>last_shown_obj_id</code> - id of the last item in favorite line shown to the user. Get it from the <code>item_id_in_line</code> property of last item from previous <code>favoriteline</code> calls. This parameter is used for pagination and separation of the timeline.</p>

<p>fline = @user.favoriteline    #get first 10 items from <a href="https://github.com/user" class="user-mention">@user</a> favorite line
last_shown_obj_id = fline.last.item_id_in_line
fline_next_page = @user.favoriteline :last_shown_obj_id =&gt; last_shown_obj_id    #get next 10 items from <a href="https://github.com/user" class="user-mention">@user</a> favorite line</p>
</li>
<li>
<p><code>limit</code> - defines the count of favorited items to return.</p>

<p>fline = @user.favoriteline :limit =&gt; 20    #return first 20 items from <a href="https://github.com/user" class="user-mention">@user</a> favorite line</p>
</li>
<li>
<p><code>for_user</code> - <code>User</code>, who looks this favorite line. For him <code>is_reblogged</code> and <code>is_favorited</code> properties will been formed. </p>

<p>@user.favorite @another_user_post
@user.reblog @another_user_post</p>

<p>fline_for_unknown_user = @another_user.favoriteline</p>

<h1>For example, fline_for_unknown_user.first == @another_user_post</h1>

<p>fline_for_unknown_user.first.is_reblogged    # =&gt; false
fline_for_unknown_user.first.is_favorited    # =&gt; false</p>

<p>fline_for_user_who_reblog_and_favorite_another_user_post = @another_user.favoriteline :for_user =&gt; <a href="https://github.com/user" class="user-mention">@user</a></p>

<h1>For example, fline_for_user_who_reblog_and_favorite_another_user_post.first == @another_user_post</h1>

<p>fline_for_user_who_reblog_and_favorite_another_user_post.first.is_reblogged    # =&gt; true
fline_for_user_who_reblog_and_favorite_another_user_post.first.is_favorited    # =&gt; true</p>
</li>
</ul><p>More examples you can find in this spec[<a href="https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/favorite_spec.rb">https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/favorite_spec.rb</a>].</p>

<p>=== Reblog features</p>

<p>Reblog means that reblogged post will be added to user's blogline and to timelines of his followers. Thus, the behavior of reblogged object is similar to the post of the user who made this reblog.
User is able to reblog posts/comments:</p>

<p>@user.reblog <a href="https://github.com/post" class="user-mention">@post</a>
  @user.reblog <a href="https://github.com/comment" class="user-mention">@comment</a></p>

<p>To delete post/comment from reblogs:</p>

<p>@user.unreblog @post</p>

<p>To check that post/comment enters in reblogs:</p>

<p>@user.reblog? @post</p>

<p>Reblogs don't have their own line and are contained in user's blogline.</p>

<p>More examples you can find in this spec[<a href="https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/reblog_spec.rb">https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/reblog_spec.rb</a>].</p>

<p>=== Comment features</p>

<p>User is able to create comments for post or other comment. If you want to comment the post:</p>

<p>@user.comments.create :post_id =&gt; @post.id, :body =&gt; "comment_body"</p>

<p>If you want to comment other comment you should add <code>parent_id</code> of parent comment:</p>

<p>@user.comments.create :post_id =&gt; @parent_post.id, :body =&gt; "comment_body", :parent_id =&gt; @parent_comment.id</p>

<p>To delete comment you should use <code>destroy</code> method:</p>

<p>@comment.destroy</p>

<p>You are able to get comment line for post or comment. It consists of comments for this object in reverse chronological order.</p>

<p><i>Notice: returned array will have back order to simplify the use. Last comment is at the bottom usually.</i></p>

<p>To get comment line:</p>

<p>commentline(:last_shown_comment_id =&gt; nil, :limit =&gt; 10, :for_user =&gt; nil)</p>

<p>where <code>last_shown_comment_id</code> is id of last shown comment from previous commentline results. For example:</p>

<p>cline = @post.commentline    #get last 10 comments for @post
  last_shown_comment_id = cline.first.id    # First element is taken due to reverse order. In fact, it is the oldest of these comments.
  cline_next_page = @post.commentline :last_shown_comment_id =&gt; last_shown_comment_id</p>

<p><code>Limit</code> and <code>for_user</code> mean the same thing as in the favoriteline[<a href="https://github.com/salkar/inkwell#favorite-features">https://github.com/salkar/inkwell#favorite-features</a>].</p>

<p>More examples you can find in this spec[<a href="https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/comments_spec.rb">https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/comments_spec.rb</a>].</p>

<p>=== Follow features</p>

<p>User is able to follow another users. It allows him to get followed user's blogline in his timeline.</p>

<p>To follow user:</p>

<p>@user.follow @another_user</p>

<p>After it last 10 <code>@another_user</code> blogline's items will be transferred to <code>@user</code> timeline. And each new <code>@another_user</code> blogline item will be added to <code>@user</code> timeline.</p>

<p>To unfollow user:</p>

<p>@user.unfollow @another_user</p>

<p>To check that user is follower of another user:</p>

<p>@user.follow? @another_user</p>

<p>To get followers ids for user and ids of users, which he follow:</p>

<p>@user.followers_row
  @user.followings_row</p>

<p>Both methods return arrays of ids.</p>

<p>More examples you can find in this spec[<a href="https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/following_spec.rb">https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/following_spec.rb</a>].</p>

<p>=== Blogline feature</p>

<p>User blogline is consists of his posts and his reblogs. To get it:</p>

<p>@user.blogline(:last_shown_obj_id =&gt; nil, :limit =&gt; 10, :for_user =&gt; nil)</p>

<p>where parameters are similar with described above[<a href="https://github.com/salkar/inkwell#favorite-features">https://github.com/salkar/inkwell#favorite-features</a>] favoriteline parameters.</p>

<p>More examples you can find in this spec[<a href="https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/blogline_spec.rb">https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/blogline_spec.rb</a>].</p>

<p>=== Timeline feature</p>

<p>User timeline is consists of items from bloglines of users he follows. To get it:</p>

<p>@user.timeline(:last_shown_obj_id =&gt; nil, :limit =&gt; 10, :for_user =&gt; nil)</p>

<p>where parameters are similar with described above[<a href="https://github.com/salkar/inkwell#favorite-features">https://github.com/salkar/inkwell#favorite-features</a>] favoriteline parameters.</p>

<p>More examples you can find in this spec[<a href="https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/timeline_spec.rb">https://github.com/salkar/inkwell/blob/master/test/dummy/spec/functional/timeline_spec.rb</a>].</p>

<p>=== Community feature</p>

<p>Community is association of users. It has own blogline, consisting of posts of its members. Community member can send his post to the community blogline.
Then this post is added to the timelines of other community users.</p>

<p>When you create community you need to pass <code>owner_id</code>:</p>

<p>@community = Community.create :name =&gt; "Community", :owner_id =&gt; @user.id </p>

<p>User with the passed id will be the first administrator of created community and will be added to it.</p>

<p>To add a user to the open community:</p>

<p>@user.join @community</p>

<p>After it last 10 <code>@community</code> blogline's items will be transferred to <code>@user</code> timeline. And each new <code>@community</code> blogline item will be added to <code>@user</code> timeline.
Moreover <code>@user</code> will be able to add their posts in community blogline.</p>

<p>To remove a user from community:</p>

<p>@admin.kick :user =&gt; @user, :from_community =&gt; @community</p>

<p>where <code>admin</code> is community administrator and <code>@user</code> is deleted user.</p>

<p>If user leave community:</p>

<p>@user.leave @community</p>

<p>After leaving the community (both methods) its blogline items will be removed from the user timeline.</p>

<p>To send post to the community blogline:</p>

<p>@user.send_post_to_community :post =&gt; @user_post, :to_community =&gt; @community</p>

<p>Sent post will be added to timelines of community members. A post can be sent to the community only by its owner.</p>

<p>To remove post from community blogline:</p>

<p>@user.remove_post_from_community :post =&gt; @user_post, :from_community =&gt; @community</p>

<p>or </p>

<p>@admin.remove_post_from_community :post =&gt; @user_post, :from_community =&gt; @community</p>

<p>Only post owner or administrator of community can remove the post from the community blogline.</p>

<p>To check that the user is a member of the community:</p>

<p>@community.include_user? @user</p>

<p>To check that the user is an admin of the community:</p>

<p>@community.include_admin? @user</p>

<p>Each administrator has the access level. Community owner has access level 0. Administrators, to whom he granted admin permissions, have access level 1 and so on.
Thus the lower the access level, the more permissions. For example, admin with access level 0 can delete admin with access level 1 but not vice versa.</p>

<p>To grant admin permissions:</p>

<p>@admin.grant_admin_permissions :to_user =&gt; @new_admin, :in_community =&gt; @community</p>

<p>To revoke admin permissions:</p>

<p>@admin.revoke_admin_permissions :user =&gt; @admin_who_is_removed, :in_community =&gt; @community</p>

<p>To get admin's access level:</p>

<p>@community.admin_level_of @admin </p>

<p>To get communities ids in which there is this post:</p>

<p>@post.communities_row</p>

<p>To get ids of community members:</p>

<p>@community.users_row</p>

<p>To get ids of communities to which the user has joined:</p>

<p>@user.communities_row</p>

<p>Community blogline is consists of the posts of members that have added to it. To get it:</p>

<p>@community.blogline(:last_shown_obj_id =&gt; nil, :limit =&gt; 10, :for_user =&gt; nil)</p>

<p>where parameters are similar with described above[<a href="https://github.com/salkar/inkwell#favorite-features">https://github.com/salkar/inkwell#favorite-features</a>] favoriteline parameters.</p>

<p>More examples you can find in this spec[<a href="https://github.com/salkar/inkwell/blob/master/lib/acts_as_inkwell_community/base.rb">https://github.com/salkar/inkwell/blob/master/lib/acts_as_inkwell_community/base.rb</a>]</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/salkar/inkwell/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/salkar/inkwell/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/salkar/inkwell"></a> is maintained by <a href="https://github.com/salkar">salkar</a>.</p>

          <p>This page was generated by <a href="pages.github.com">GitHub Pages</a> using the Architect theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>